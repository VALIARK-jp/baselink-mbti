# Baselink AI 16タイプ野球診断 開発仕様書

## 目次

1. [アーキテクチャ概要](#アーキテクチャ概要)
2. [データ構造](#データ構造)
3. [MBTI判定ロジック](#mbti判定ロジック)
4. [質問リスト](#質問リスト)
5. [診断結果マッピング](#診断結果マッピング)
6. [コンポーネント設計](#コンポーネント設計)
7. [画面遷移フロー](#画面遷移フロー)

## アーキテクチャ概要

### システム構成

```
┌─────────────────┐
│  Position Select │ (index.tsx)
│ 投手/野手選択    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   Quiz Phase    │ (quiz.tsx)
│   質問表示      │
│   回答収集      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  MBTI Calculate │ (calculateMBTI.ts)
│   スコア集計    │
│   タイプ判定    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Result Display │ (result.tsx)
│   結果表示      │
│   AI誘導        │
└─────────────────┘
```

### 技術スタック詳細

- **Next.js Pages Router**: ページルーティングとSSR/SSG対応
- **TypeScript**: 型安全性の確保
- **Tailwind CSS**: ユーティリティファーストのスタイリング
- **React Hooks**: 状態管理（useState, useRouter）

## データ構造

### 型定義

```typescript
// ポジションタイプ
type Position = 'pitcher' | 'batter';

// MBTI指標
type TraitPair = 'EI' | 'SN' | 'TF' | 'JP';
type TraitValue = 'E' | 'I' | 'S' | 'N' | 'T' | 'F' | 'J' | 'P';

// MBTIタイプ（16種類）
type MBTIType = 
  | 'ISTJ' | 'ISFJ' | 'INFJ' | 'INTJ'
  | 'ISTP' | 'ISFP' | 'INFP' | 'INTP'
  | 'ESTP' | 'ESFP' | 'ENFP' | 'ENTP'
  | 'ESTJ' | 'ESFJ' | 'ENFJ' | 'ENTJ';

// 質問データ構造
interface Question {
  id: string;
  text: string;
  a: { label: string; trait: TraitValue };
  b: { label: string; trait: TraitValue };
}

// 診断結果データ構造
interface ResultData {
  title: string;      // タイプ名（例: "孤高の奪三振王"）
  player: string;     // 似ている選手名（例: "佐々木朗希"）
  desc: string;       // タイプの説明
  advice: string;     // Baselink AIへの誘導メッセージ
}

// スコアリングデータ
interface MBTIScores {
  E: number;
  I: number;
  S: number;
  N: number;
  T: number;
  F: number;
  J: number;
  P: number;
}
```

## MBTI判定ロジック

### アルゴリズム概要

1. **質問回答の収集**: ユーザーが10問の質問にA/Bで回答
2. **スコアリング**: 各回答に対応するMBTI指標に加点
   - 回答A選択時: `question.a.trait` に +1
   - 回答B選択時: `question.b.trait` に +1
3. **タイプ判定**: 4つのペア（EI, SN, TF, JP）でスコアを比較
   - E vs I: 多い方を採用
   - S vs N: 多い方を採用
   - T vs F: 多い方を採用
   - J vs P: 多い方を採用
4. **結果取得**: `position × MBTIType` の組み合わせで結果データを取得

### スコアリング例

```
質問1: 回答A → Eに+1
質問2: 回答B → Nに+1
質問3: 回答A → Tに+1
質問4: 回答A → Jに+1
...

最終スコア:
E: 3, I: 2 → E
S: 2, N: 3 → N
T: 4, F: 1 → T
J: 3, P: 2 → J

判定結果: ENTJ
```

### 実装コード例

```typescript
function calculateMBTI(
  answers: string[],
  questions: Question[]
): MBTIType {
  const scores: MBTIScores = {
    E: 0, I: 0, S: 0, N: 0,
    T: 0, F: 0, J: 0, P: 0
  };

  questions.forEach((q, idx) => {
    const answer = answers[idx];
    const selected = answer === 'A' ? q.a : q.b;
    scores[selected.trait]++;
  });

  let type = '';
  type += scores.E >= scores.I ? 'E' : 'I';
  type += scores.S >= scores.N ? 'S' : 'N';
  type += scores.T >= scores.F ? 'T' : 'F';
  type += scores.J >= scores.P ? 'J' : 'P';

  return type as MBTIType;
}
```

## 質問リスト

### 共通質問（6問）

全ユーザーが回答する性格特性を判定する質問。

| No | 質問内容 | 回答A（trait） | 回答B（trait） |
|----|---------|---------------|---------------|
| 1 | 練習中、一番やる気が出るのは？ | 仲間と競い合う (E) | 一人で向き合う (I) |
| 2 | 理想の成長の仕方は？ | 試合で経験を積む (S) | 理屈を理解する (N) |
| 3 | 監督のアドバイスに対して | 勝率や理屈を重視 (T) | 感覚や熱意を重視 (F) |
| 4 | 試合当日の朝は？ | 決まったルーティン (J) | その時の気分 (P) |
| 5 | 初対面の他校の選手と | すぐに話せる (E) | 様子を見る (I) |
| 6 | 自分のプレーが崩れた時 | 基本に戻る (J) | 新しいことを試す (P) |

### 投手専用質問（4問）

| No | 質問内容 | 回答A（trait） | 回答B（trait） |
|----|---------|---------------|---------------|
| 7 | 理想のピッチングは？ | 直球でねじ伏せる (S) | 変化球で翻弄 (N) |
| 8 | ピンチの場面での思考 | 相手を分析 (T) | 気持ちで投げる (F) |
| 9 | 周囲からの評価は？ | 安定感がある (J) | 爆発力がある (P) |
| 10 | 研究したいデータは？ | 自分の出力 (S) | 相手の反応 (N) |

### 野手専用質問（4問）

| No | 質問内容 | 回答A（trait） | 回答B（trait） |
|----|---------|---------------|---------------|
| 7 | 打席での意識は？ | 全力で叩く (S) | 裏をかく (N) |
| 8 | チームでの役割は？ | 結果で貢献 (T) | 雰囲気で支える (F) |
| 9 | 練習への姿勢 | 決まった数をこなす (J) | 感覚を調整する (P) |
| 10 | 憧れるプレーは？ | 泥臭い守備・走塁 (S) | 華やかな打撃 (N) |

## 診断結果マッピング

### 投手版 16タイプ

| MBTI | タイトル | 選手 | 説明 | AI誘導メッセージ |
|------|---------|------|------|-----------------|
| ISTJ | 制球の精密機械 | 菅野智之 | 1ミリの狂いもなく低めに集める安定感抜群の投手。 | 日々の練習の「ズレ」をAIで記録し、精度を極めよう。 |
| ISFJ | 献身のリリーフ | 宮西尚生 | どんな場面でも準備を怠らない、チームに不可欠な左腕。 | 日々の準備（ルーティン）をAIに書き留め、自信に変えよう。 |
| INFJ | 静かなる完投右腕 | 桑田真澄 | 理想のフォームと理論を追求し、黙々と投げ抜く。 | 君の深い思考をAIで言語化し、理想のフォームを形にしよう。 |
| INTJ | 戦略的マエストロ | ダルビッシュ有 | 相手の弱点を徹底分析し、知略で封じる支配者。 | 緻密な配球戦略をAIノートに整理し、攻略本を作ろう。 |
| ISTP | 孤高の奪三振王 | 佐々木朗希 | 圧倒的な素材と技術で三振の山を築く天才。 | その「キレ」の感覚をAIに言葉で残し、再現性を高めよう。 |
| ISFP | 野性のサウスポー | 井川慶 | 天性のセンスとキレで打者を翻弄する。 | 無意識の好プレーをAIで振り返り、天才の感覚を言語化しよう。 |
| INFP | 理想を追う左腕 | 杉内俊哉 | 芸術的な軌道と美しさを追求するサウスポー。 | 理想のボールを投げた時の感覚をAIにストックしよう。 |
| INTP | 投球理論の探究者 | 今永昇太 | 独自の理論を持ち、スイングを研究し続ける哲学者。 | 君の「なぜ？」をAIに書き出し、最強の理論を構築しよう。 |
| ESTP | 剛腕ねじ伏せエース | 山本由伸 | 常に真っ向勝負を挑み、力でねじ伏せるエース。 | 爆発的なパワーの源をAIで言語化し、安定感を手に入れよう。 |
| ESFP | 華やかなる先発 | 佐々木主浩 | 観客を魅了するフォームとスピードを持つスター。 | 最高にノっている時の感覚をAIで記録し、いつでも引き出そう。 |
| ENFP | 劇場型クローザー | 山﨑康晃 | 勢いに乗ると手がつけられない、魂の守護神。 | 感情とプレーの連動をAIで整理し、メンタルを武器にしよう。 |
| ENTP | 予測不能の策士 | 伊藤大海 | 意表を突く配球で打者を丸裸にする天才。 | 独自のアイデアをAIにメモし、自分だけの勝ち筋を作ろう。 |
| ESTJ | 鉄腕キャプテン | 松坂大輔 | 厳しい練習で培った地力でチームを引っ張る。 | 練習の質と量をAIで可視化し、揺るぎない自信を作ろう。 |
| ESFJ | 絆の守護神 | 藤川球児 | 仲間の期待に応える、魂の火の玉ストレート。 | 仲間との対話をAIに記録し、最高のチームを作ろう。 |
| ENFJ | 情熱のエース | 大谷翔平(投) | 全員の想いを背負って投げる、誰もが認める主人公。 | 高い目標をAIに宣言し、日々の進化を言葉に刻もう。 |
| ENTJ | マウンドの支配者 | 田中将大 | 圧倒的な威圧感で試合の流れを掌握する。 | 勝つための改善点をAIで言語化し、圧倒的な質を追求しよう。 |

### 野手版 16タイプ

| MBTI | タイトル | 選手 | 説明 | AI誘導メッセージ |
|------|---------|------|------|-----------------|
| ISTJ | 守備のスペシャリスト | 源田壮亮 | 派手さはないが、絶対にエラーをしない精密機械。 | 完璧な守備へのプロセスをAIで言語化しよう。 |
| ISFJ | 繋ぎの職人 | 菊池涼介 | チームの勝利のために、献身的に役割を果たす。 | 職人技のコツをAIにメモし、自分だけの武器を磨こう。 |
| INFJ | 不動の精神的支柱 | 松井秀喜 | 背中で語り、チームを勝利へ導く不屈の主砲。 | 君の強い志をAIで言葉にし、不動のメンタルを作ろう。 |
| INTJ | 狙い撃ちのヒットメーカー | 落合博満 | 配球を読み切り、狙った所に運ぶ天才打者。 | 配球の読みをAIでログ化し、打撃の精度を究極まで高めよう。 |
| ISTP | 孤高の天才 | イチロー | 無駄を削ぎ落とし、技術のみで語る仕事人。 | 0.1ミリの感触をAIで言語化し、技術を一生モノにしよう。 |
| ISFP | 本能のフルスイング | 柳田悠岐 | 圧倒的な身体能力を活かし、規格外に飛ばす。 | 爆発的な感覚をAIで言葉に変え、好不調の波をなくそう。 |
| INFP | 芸術的バットマン | 前田智徳 | 独自の感性で美しいフォームを追求する好打者。 | こだわり抜いたフォームの感覚をAIに保存しよう。 |
| INTP | 打撃理論の求道者 | 近藤健介 | スイングメカニズムを追求し続ける理論派。 | 君の打撃理論をAIで整理し、最強の教科書を作ろう。 |
| ESTP | 豪快なる怪物 | 村上宗隆 | 飛距離こそが正義、力でねじ伏せるスラッガー。 | インパクトの瞬間の感覚をAIで言語化し、本塁打を量産しよう。 |
| ESFP | 華麗なるスピードスター | 坂本勇人 | 魅せるプレーで球場を沸かせる、スピードと華がある選手。 | 最高のパフォーマンスのコツをAIで言葉にし、スターになろう。 |
| ENFP | お祭りスラッガー | 牧秀悟 | 勢いに乗ると手がつけられない、勝利の女神。 | エネルギーの源をAIで整理し、常に高いパフォーマンスを出そう。 |
| ENTP | 奇才のアタッカー | 長嶋茂雄 | 常識に縛られないスイングでチャンスを創出する。 | 独創的な発想をAIでメモし、誰も真似できない打者へ。 |
| ESTJ | 努力の鉄人 | 秋山幸二 | 猛練習で鍛え上げた勝負強さと地力を持つ。 | 日々の積み重ねをAIで可視化し、確固たる自信を築こう。 |
| ESFJ | チームの潤滑油 | 近本光司 | 全員の期待に応える、俊足巧打の万能選手。 | チームのためのプレーをAIで振り返り、最高の繋ぎ役へ。 |
| ENFJ | 太陽のリーダー | 鈴木誠也 | 常に全力プレーで周囲を鼓舞する、真の主人公。 | リーダーとしての気づきをAIに刻み、最強のチームを作ろう。 |
| ENTJ | 最強の主砲 | 岡本和真 | 勝利への最短距離を叩き出す、計算された破壊力。 | 勝つための打撃戦略をAIで言語化し、質を極めよう。 |

## コンポーネント設計

### PositionSelector.tsx

**責務**: 投手/野手の選択画面を表示

**Props**: なし

**State**: なし（親コンポーネントにイベントハンドラーを渡す）

**主要機能**:
- ポジション選択ボタンの表示
- 選択後のルーティング（`/quiz?position=pitcher` または `/quiz?position=batter`）

### QuizComponent.tsx

**責務**: 質問表示と回答処理

**Props**:
```typescript
{
  questions: Question[];
  onAnswer: (answer: 'A' | 'B') => void;
  currentIndex: number;
  totalQuestions: number;
}
```

**State**: 
- 現在の質問インデックス（親から受け取る）
- 回答履歴（親で管理）

**主要機能**:
- 質問文の表示
- 回答ボタン（A/B）の表示
- プログレスバーの表示
- 回答時のコールバック実行

### ResultCard.tsx

**責務**: 診断結果の表示

**Props**:
```typescript
{
  result: ResultData;
  mbtiType: MBTIType;
  position: Position;
  onBaselinkClick: () => void;
}
```

**主要機能**:
- 野球カード風デザインでの結果表示
- タイプ名、選手名、説明の表示
- Baselink AI誘導ボタン
- SNSシェア機能（オプション）

## 画面遷移フロー

### 1. エントリー（/）

```
ユーザーアクセス
  ↓
PositionSelector コンポーネント表示
  ↓
「投手」または「野手」ボタンクリック
  ↓
/quiz?position={selected} へ遷移
```

### 2. 診断（/quiz）

```
URLパラメータから position を取得
  ↓
共通質問6問 + ポジション別質問4問を結合
  ↓
QuizComponent で質問表示
  ↓
ユーザーが回答
  ↓
回答を配列に保存（['A', 'B', 'A', ...]）
  ↓
全10問回答完了
  ↓
/result へ遷移（クエリパラメータで回答データを渡す）
```

### 3. 結果表示（/result）

```
URLパラメータから回答データとpositionを取得
  ↓
calculateMBTI() でMBTIタイプを計算
  ↓
position × MBTIType で結果データを取得
  ↓
ResultCard で結果表示
  ↓
「Baselink AIで言語化する」ボタンクリック
  ↓
Baselink AIサービスへリダイレクト
```

### 状態管理

- ページ間のデータ受け渡しはURLクエリパラメータを使用
- セッションストレージやローカルストレージは使用しない（シンプルさ重視）

## UI/UX要件

### デザインガイドライン

- **メインカラー**: #1D4ED8 (Baselink Blue), #B45309 (Gold)
- **フォント**: 太字のサンセリフ体（游ゴシック、ヒラギノ角ゴなど）
- **レスポンシブ**: モバイルファーストデザイン
- **アニメーション**: 結果表示時のフェードイン、ボタンホバー効果

### アクセシビリティ

- キーボード操作対応
- コントラスト比の確保（WCAG 2.1 AA準拠）
- スクリーンリーダー対応（aria-label等）

## パフォーマンス要件

- First Contentful Paint (FCP): < 1.5秒
- Largest Contentful Paint (LCP): < 2.5秒
- 診断完了までの時間: 2-3分程度

## セキュリティ考慮事項

- XSS対策: Reactの自動エスケープに依存
- 個人情報の取り扱い: 診断結果はサーバーに保存しない
- URLパラメータの検証: position, answers の値チェック

## 今後の拡張予定

- SNSシェア機能（OGP画像生成）
- 診断結果の画像ダウンロード
- 診断履歴のローカルストレージ保存
- 多言語対応（オプション）


